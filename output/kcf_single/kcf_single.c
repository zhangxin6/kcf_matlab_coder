/*
 * File: kcf_single.c
 *
 * MATLAB Coder version            : 3.4
 * C/C++ source code generated on  : 17-Aug-2020 11:43:07
 */

/* Include Files */
#include "rt_nonfinite.h"
#include "kcf_single.h"
#include "fclose.h"
#include "fft1.h"
#include "ifWhileCond.h"
#include "fileManager.h"
#include "kcf_single_data.h"
#include <stdio.h>

/* Function Declarations */
static void linear_correlation(const creal_T xf[256], const creal_T yf[256],
  creal_T kf[256]);

/* Function Definitions */

/*
 * Arguments    : const creal_T xf[256]
 *                const creal_T yf[256]
 *                creal_T kf[256]
 * Return Type  : void
 */
static void linear_correlation(const creal_T xf[256], const creal_T yf[256],
  creal_T kf[256])
{
  int k;
  creal_T x[256];
  for (k = 0; k < 256; k++) {
    x[k].re = xf[k].re * yf[k].re - xf[k].im * -yf[k].im;
    x[k].im = xf[k].re * -yf[k].im + xf[k].im * yf[k].re;
    kf[k].re = 0.0;
    kf[k].im = 0.0;
  }

  for (k = 0; k < 16; k++) {
    memcpy(&kf[k << 4], &x[k << 4], sizeof(creal_T) << 4);
  }

  for (k = 0; k < 256; k++) {
    if (kf[k].im == 0.0) {
      kf[k].re /= 256.0;
      kf[k].im = 0.0;
    } else if (kf[k].re == 0.0) {
      kf[k].re = 0.0;
      kf[k].im /= 256.0;
    } else {
      kf[k].re /= 256.0;
      kf[k].im /= 256.0;
    }
  }
}

/*
 * Arguments    : double frame_begin
 *                double frame_num
 * Return Type  : void
 */
void kcf_single(double frame_begin, double frame_num)
{
  int ii;
  signed char fileid;
  double pos[2];
  creal_T model_xf[256];
  creal_T model_alphaf[256];
  FILE * b_NULL;
  int frame;
  static const double dv0[9] = { 1.0, 0.92387953251128674, 0.70710678118654757,
    0.38268343236508978, 0.0, -0.38268343236508978, -0.70710678118654757,
    -0.92387953251128674, -1.0 };

  static const double dv1[9] = { 0.0, -0.38268343236508978, -0.70710678118654757,
    -0.92387953251128674, -1.0, -0.92387953251128674, -0.70710678118654757,
    -0.38268343236508978, -0.0 };

  creal_T dcv0[256];
  creal_T b_model_alphaf[256];
  creal_T dcv1[256];
  int ixstart;
  creal_T xf[256];
  static const double dv2[9] = { 0.0, 0.38268343236508978, 0.70710678118654757,
    0.92387953251128674, 1.0, 0.92387953251128674, 0.70710678118654757,
    0.38268343236508978, 0.0 };

  double mtmp;
  double bi;
  signed char b_fileid;
  static const creal_T x[256] = { { 9.8017690714069889,/* re */
      0.0                              /* im */
    }, { 8.6909050655080513,           /* re */
      0.0                              /* im */
    }, { 6.0582420798919028,           /* re */
      0.0                              /* im */
    }, { 3.3200859132501725,           /* re */
      2.2204460492503131E-16           /* im */
    }, { 1.4304516479228853,           /* re */
      0.0                              /* im */
    }, { 0.48453164500749857,          /* re */
      2.2204460492503131E-16           /* im */
    }, { 0.12908649766677849,          /* re */
      0.0                              /* im */
    }, { 0.027588202039029674,         /* re */
      0.0                              /* im */
    }, { 0.008892191064857613,         /* re */
      0.0                              /* im */
    }, { 0.027588202039029674,         /* re */
      0.0                              /* im */
    }, { 0.12908649766677849,          /* re */
      0.0                              /* im */
    }, { 0.48453164500749857,          /* re */
      -2.2204460492503131E-16          /* im */
    }, { 1.4304516479228853,           /* re */
      0.0                              /* im */
    }, { 3.3200859132501725,           /* re */
      -2.2204460492503131E-16          /* im */
    }, { 6.0582420798919028,           /* re */
      0.0                              /* im */
    }, { 8.6909050655080513,           /* re */
      0.0                              /* im */
    }, { 8.6909050655080531,           /* re */
      -1.1807136369252272E-16          /* im */
    }, { 7.7059386226522637,           /* re */
      2.2204460502842888E-16           /* im */
    }, { 5.3716432611943521,           /* re */
      -1.0339757656912846E-25          /* im */
    }, { 2.9438105785985371,           /* re */
      2.2204460502842888E-16           /* im */
    }, { 1.2683342550032974,           /* re */
      1.6939624969320315E-21           /* im */
    }, { 0.42961821456074656,          /* re */
      2.2204460502842888E-16           /* im */
    }, { 0.11445673615526841,          /* re */
      -1.0339757656912846E-25          /* im */
    }, { 0.024461548022866264,         /* re */
      2.2204460502842888E-16           /* im */
    }, { 0.0078844122735421962,        /* re */
      1.1806797535393855E-16           /* im */
    }, { 0.024461548022866264,         /* re */
      -2.2204460482163373E-16          /* im */
    }, { 0.11445673615526841,          /* re */
      -1.0339757656912846E-25          /* im */
    }, { 0.42961821456074656,          /* re */
      -2.2204460482163373E-16          /* im */
    }, { 1.2683342550032974,           /* re */
      1.6939624969320315E-21           /* im */
    }, { 2.9438105785985371,           /* re */
      -2.2204460482163373E-16          /* im */
    }, { 5.3716432611943521,           /* re */
      -1.0339757656912846E-25          /* im */
    }, { 7.7059386226522637,           /* re */
      -2.2204460482163373E-16          /* im */
    }, { 6.0582420798919037,           /* re */
      0.0                              /* im */
    }, { 5.3716432611943521,           /* re */
      -1.1102230246251565E-16          /* im */
    }, { 3.7444564171215027,           /* re */
      0.0                              /* im */
    }, { 2.0520667281565834,           /* re */
      1.1102230246251565E-16           /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 0.29947757179738455,          /* re */
      1.1102230246251565E-16           /* im */
    }, { 0.079785316957940555,         /* re */
      0.0                              /* im */
    }, { 0.017051616425953764,         /* re */
      -1.1102230246251565E-16          /* im */
    }, { 0.0054960533857819627,        /* re */
      0.0                              /* im */
    }, { 0.017051616425953764,         /* re */
      1.1102230246251565E-16           /* im */
    }, { 0.079785316957940555,         /* re */
      0.0                              /* im */
    }, { 0.29947757179738455,          /* re */
      -1.1102230246251565E-16          /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 2.0520667281565834,           /* re */
      -1.1102230246251565E-16          /* im */
    }, { 3.7444564171215027,           /* re */
      0.0                              /* im */
    }, { 5.3716432611943521,           /* re */
      1.1102230246251565E-16           /* im */
    }, { 3.320085913250173,            /* re */
      1.9888505003693651E-16           /* im */
    }, { 2.9438105785985371,           /* re */
      1.9428902920600482E-16           /* im */
    }, { 2.0520667281565839,           /* re */
      8.2182524777798813E-17           /* im */
    }, { 1.1245898970949688,           /* re */
      1.38777877974747E-16             /* im */
    }, { 0.48452706151875757,          /* re */
      8.4349235056875313E-17           /* im */
    }, { 0.16412207606543922,          /* re */
      8.3266726743489164E-17           /* im */
    }, { 0.043724582712776794,         /* re */
      8.2182524777798813E-17           /* im */
    }, { 0.0093447621847035922,        /* re */
      8.3266726743489164E-17           /* im */
    }, { 0.0030119908026076114,        /* re */
      -3.0179803659607846E-17          /* im */
    }, { 0.0093447621847035922,        /* re */
      -2.775557571902649E-17           /* im */
    }, { 0.043724582712776794,         /* re */
      8.2182524777798813E-17           /* im */
    }, { 0.1641220760654391,           /* re */
      2.7755575512231337E-17           /* im */
    }, { 0.48452706151875757,          /* re */
      8.4349235056875313E-17           /* im */
    }, { 1.1245898970949688,           /* re */
      8.3266726743489164E-17           /* im */
    }, { 2.0520667281565839,           /* re */
      8.2182524777798813E-17           /* im */
    }, { 2.9438105785985371,           /* re */
      8.3266726743489164E-17           /* im */
    }, { 1.4304516479228853,           /* re */
      0.0                              /* im */
    }, { 1.2683342550032974,           /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 0.48452706151875718,          /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.20875740921241454,          /* re */
      0.0                              /* im */
    }, { 0.070711632259692736,         /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.018838639429966719,         /* re */
      0.0                              /* im */
    }, { 0.0040261700497595809,        /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.001297709553214621,         /* re */
      0.0                              /* im */
    }, { 0.0040261700497595809,        /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.018838639429966719,         /* re */
      0.0                              /* im */
    }, { 0.070711632259692736,         /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.20875740921241454,          /* re */
      0.0                              /* im */
    }, { 0.48452706151875718,          /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 1.2683342550032974,           /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.4845316450074979,           /* re */
      1.9888505003693651E-16           /* im */
    }, { 0.42961821456074611,          /* re */
      1.8041124139819036E-16           /* im */
    }, { 0.29947757179738449,          /* re */
      1.515714638168711E-16            /* im */
    }, { 0.16412207606543922,          /* re */
      1.38777877974747E-16             /* im */
    }, { 0.070711632259692875,         /* re */
      8.4349235056875313E-17           /* im */
    }, { 0.023951892082270054,         /* re */
      5.2041704175906636E-17           /* im */
    }, { 0.0063811433025082187,        /* re */
      1.2793585738726529E-17           /* im */
    }, { 0.0013637698276083299,        /* re */
      -1.3877787911212033E-17          /* im */
    }, { 0.00043956840168207778,       /* re */
      -3.0179803659607846E-17          /* im */
    }, { 0.0013637698276083576,        /* re */
      -1.3877787911212033E-17          /* im */
    }, { 0.0063811433025082187,        /* re */
      1.2793585738726529E-17           /* im */
    }, { 0.023951892082270054,         /* re */
      2.7755575512231337E-17           /* im */
    }, { 0.070711632259692875,         /* re */
      8.4349235056875313E-17           /* im */
    }, { 0.16412207606543922,          /* re */
      1.1449174931107169E-16           /* im */
    }, { 0.29947757179738449,          /* re */
      1.515714638168711E-16            /* im */
    }, { 0.42961821456074611,          /* re */
      1.8041124139819036E-16           /* im */
    }, { 0.12908649766677871,          /* re */
      0.0                              /* im */
    }, { 0.11445673615526841,          /* re */
      0.0                              /* im */
    }, { 0.079785316957940625,         /* re */
      0.0                              /* im */
    }, { 0.043724582712776815,         /* re */
      8.6736173798840355E-19           /* im */
    }, { 0.018838639429966813,         /* re */
      0.0                              /* im */
    }, { 0.0063811433025082118,        /* re */
      8.6736173798840355E-19           /* im */
    }, { 0.0017000322858537753,        /* re */
      0.0                              /* im */
    }, { 0.0003633287371082386,        /* re */
      0.0                              /* im */
    }, { 0.00011710761524603985,       /* re */
      0.0                              /* im */
    }, { 0.0003633287371082386,        /* re */
      0.0                              /* im */
    }, { 0.0017000322858537753,        /* re */
      0.0                              /* im */
    }, { 0.0063811433025082118,        /* re */
      -8.6736173798840355E-19          /* im */
    }, { 0.018838639429966813,         /* re */
      0.0                              /* im */
    }, { 0.043724582712776815,         /* re */
      -8.6736173798840355E-19          /* im */
    }, { 0.079785316957940625,         /* re */
      0.0                              /* im */
    }, { 0.11445673615526841,          /* re */
      0.0                              /* im */
    }, { 0.027588202039028953,         /* re */
      -1.1807136369252272E-16          /* im */
    }, { 0.024461548022865064,         /* re */
      -1.0581813193118766E-16          /* im */
    }, { 0.017051616425953091,         /* re */
      -7.3725747832411878E-17          /* im */
    }, { 0.00934476218470305,          /* re */
      -3.5561831154126969E-17          /* im */
    }, { 0.0040261700497591525,        /* re */
      1.6939624969320315E-21           /* im */
    }, { 0.0013637698276080064,        /* re */
      3.6429193098910526E-17           /* im */
    }, { 0.00036332873710796278,       /* re */
      7.3725747625616725E-17           /* im */
    }, { 7.7650155415602551E-5,        /* re */
      1.0495077039999441E-16           /* im */
    }, { 2.502809052895745E-5,         /* re */
      1.1806797535393855E-16           /* im */
    }, { 7.7650155415602551E-5,        /* re */
      1.0581813213798281E-16           /* im */
    }, { 0.00036332873710796278,       /* re */
      7.3725747625616725E-17           /* im */
    }, { 0.0013637698276080055,        /* re */
      3.5561831360922122E-17           /* im */
    }, { 0.0040261700497591525,        /* re */
      1.6939624969320315E-21           /* im */
    }, { 0.0093447621847030475,        /* re */
      -3.6429192892115372E-17          /* im */
    }, { 0.017051616425953091,         /* re */
      -7.3725747832411878E-17          /* im */
    }, { 0.024461548022865064,         /* re */
      -1.0495077019319925E-16          /* im */
    }, { 0.00889219106485805,          /* re */
      0.0                              /* im */
    }, { 0.0078844122735434417,        /* re */
      2.1684043449710089E-19           /* im */
    }, { 0.0054960533857820442,        /* re */
      0.0                              /* im */
    }, { 0.003011990802607559,         /* re */
      2.1684043449710089E-19           /* im */
    }, { 0.0012977095532144473,        /* re */
      0.0                              /* im */
    }, { 0.00043956840168158165,       /* re */
      2.1684043449710089E-19           /* im */
    }, { 0.00011710761524531864,       /* re */
      0.0                              /* im */
    }, { 2.5028090528259224E-5,        /* re */
      2.1684043449710089E-19           /* im */
    }, { 8.0670194682512866E-6,        /* re */
      0.0                              /* im */
    }, { 2.5028090528259224E-5,        /* re */
      -2.1684043449710089E-19          /* im */
    }, { 0.00011710761524531864,       /* re */
      0.0                              /* im */
    }, { 0.00043956840168158165,       /* re */
      -2.1684043449710089E-19          /* im */
    }, { 0.0012977095532144473,        /* re */
      0.0                              /* im */
    }, { 0.003011990802607559,         /* re */
      -2.1684043449710089E-19          /* im */
    }, { 0.0054960533857820442,        /* re */
      0.0                              /* im */
    }, { 0.0078844122735434417,        /* re */
      -2.1684043449710089E-19          /* im */
    }, { 0.027588202039028953,         /* re */
      1.1807136369252272E-16           /* im */
    }, { 0.024461548022865064,         /* re */
      1.0495077019319925E-16           /* im */
    }, { 0.017051616425953091,         /* re */
      7.3725747832411878E-17           /* im */
    }, { 0.0093447621847030475,        /* re */
      3.6429192892115372E-17           /* im */
    }, { 0.0040261700497591525,        /* re */
      -1.6939624969320315E-21          /* im */
    }, { 0.0013637698276080055,        /* re */
      -3.5561831360922122E-17          /* im */
    }, { 0.00036332873710796278,       /* re */
      -7.3725747625616725E-17          /* im */
    }, { 7.7650155415602551E-5,        /* re */
      -1.0581813213798281E-16          /* im */
    }, { 2.502809052895745E-5,         /* re */
      -1.1806797535393855E-16          /* im */
    }, { 7.7650155415602551E-5,        /* re */
      -1.0495077039999441E-16          /* im */
    }, { 0.00036332873710796278,       /* re */
      -7.3725747625616725E-17          /* im */
    }, { 0.0013637698276080064,        /* re */
      -3.6429193098910526E-17          /* im */
    }, { 0.0040261700497591525,        /* re */
      -1.6939624969320315E-21          /* im */
    }, { 0.00934476218470305,          /* re */
      3.5561831154126969E-17           /* im */
    }, { 0.017051616425953091,         /* re */
      7.3725747832411878E-17           /* im */
    }, { 0.024461548022865064,         /* re */
      1.0581813193118766E-16           /* im */
    }, { 0.12908649766677871,          /* re */
      0.0                              /* im */
    }, { 0.11445673615526841,          /* re */
      0.0                              /* im */
    }, { 0.079785316957940625,         /* re */
      0.0                              /* im */
    }, { 0.043724582712776815,         /* re */
      8.6736173798840355E-19           /* im */
    }, { 0.018838639429966813,         /* re */
      0.0                              /* im */
    }, { 0.0063811433025082118,        /* re */
      8.6736173798840355E-19           /* im */
    }, { 0.0017000322858537753,        /* re */
      0.0                              /* im */
    }, { 0.0003633287371082386,        /* re */
      0.0                              /* im */
    }, { 0.00011710761524603985,       /* re */
      0.0                              /* im */
    }, { 0.0003633287371082386,        /* re */
      0.0                              /* im */
    }, { 0.0017000322858537753,        /* re */
      0.0                              /* im */
    }, { 0.0063811433025082118,        /* re */
      -8.6736173798840355E-19          /* im */
    }, { 0.018838639429966813,         /* re */
      0.0                              /* im */
    }, { 0.043724582712776815,         /* re */
      -8.6736173798840355E-19          /* im */
    }, { 0.079785316957940625,         /* re */
      0.0                              /* im */
    }, { 0.11445673615526841,          /* re */
      0.0                              /* im */
    }, { 0.4845316450074979,           /* re */
      -1.9888505003693651E-16          /* im */
    }, { 0.42961821456074611,          /* re */
      -1.8041124139819036E-16          /* im */
    }, { 0.29947757179738449,          /* re */
      -1.515714638168711E-16           /* im */
    }, { 0.16412207606543922,          /* re */
      -1.1449174931107169E-16          /* im */
    }, { 0.070711632259692875,         /* re */
      -8.4349235056875313E-17          /* im */
    }, { 0.023951892082270054,         /* re */
      -2.7755575512231337E-17          /* im */
    }, { 0.0063811433025082187,        /* re */
      -1.2793585738726529E-17          /* im */
    }, { 0.0013637698276083576,        /* re */
      1.3877787911212033E-17           /* im */
    }, { 0.00043956840168207778,       /* re */
      3.0179803659607846E-17           /* im */
    }, { 0.0013637698276083299,        /* re */
      1.3877787911212033E-17           /* im */
    }, { 0.0063811433025082187,        /* re */
      -1.2793585738726529E-17          /* im */
    }, { 0.023951892082270054,         /* re */
      -5.2041704175906636E-17          /* im */
    }, { 0.070711632259692875,         /* re */
      -8.4349235056875313E-17          /* im */
    }, { 0.16412207606543922,          /* re */
      -1.38777877974747E-16            /* im */
    }, { 0.29947757179738449,          /* re */
      -1.515714638168711E-16           /* im */
    }, { 0.42961821456074611,          /* re */
      -1.8041124139819036E-16          /* im */
    }, { 1.4304516479228853,           /* re */
      0.0                              /* im */
    }, { 1.2683342550032974,           /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 0.48452706151875718,          /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.20875740921241454,          /* re */
      0.0                              /* im */
    }, { 0.070711632259692736,         /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.018838639429966719,         /* re */
      0.0                              /* im */
    }, { 0.0040261700497595809,        /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.001297709553214621,         /* re */
      0.0                              /* im */
    }, { 0.0040261700497595809,        /* re */
      5.5511151231257827E-17           /* im */
    }, { 0.018838639429966719,         /* re */
      0.0                              /* im */
    }, { 0.070711632259692736,         /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.20875740921241454,          /* re */
      0.0                              /* im */
    }, { 0.48452706151875718,          /* re */
      -5.5511151231257827E-17          /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 1.2683342550032974,           /* re */
      5.5511151231257827E-17           /* im */
    }, { 3.320085913250173,            /* re */
      -1.9888505003693651E-16          /* im */
    }, { 2.9438105785985371,           /* re */
      -8.3266726743489164E-17          /* im */
    }, { 2.0520667281565839,           /* re */
      -8.2182524777798813E-17          /* im */
    }, { 1.1245898970949688,           /* re */
      -8.3266726743489164E-17          /* im */
    }, { 0.48452706151875757,          /* re */
      -8.4349235056875313E-17          /* im */
    }, { 0.1641220760654391,           /* re */
      -2.7755575512231337E-17          /* im */
    }, { 0.043724582712776794,         /* re */
      -8.2182524777798813E-17          /* im */
    }, { 0.0093447621847035922,        /* re */
      2.775557571902649E-17            /* im */
    }, { 0.0030119908026076114,        /* re */
      3.0179803659607846E-17           /* im */
    }, { 0.0093447621847035922,        /* re */
      -8.3266726743489164E-17          /* im */
    }, { 0.043724582712776794,         /* re */
      -8.2182524777798813E-17          /* im */
    }, { 0.16412207606543922,          /* re */
      -8.3266726743489164E-17          /* im */
    }, { 0.48452706151875757,          /* re */
      -8.4349235056875313E-17          /* im */
    }, { 1.1245898970949688,           /* re */
      -1.38777877974747E-16            /* im */
    }, { 2.0520667281565839,           /* re */
      -8.2182524777798813E-17          /* im */
    }, { 2.9438105785985371,           /* re */
      -1.9428902920600482E-16          /* im */
    }, { 6.0582420798919037,           /* re */
      0.0                              /* im */
    }, { 5.3716432611943521,           /* re */
      -1.1102230246251565E-16          /* im */
    }, { 3.7444564171215027,           /* re */
      0.0                              /* im */
    }, { 2.0520667281565834,           /* re */
      1.1102230246251565E-16           /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 0.29947757179738455,          /* re */
      1.1102230246251565E-16           /* im */
    }, { 0.079785316957940555,         /* re */
      0.0                              /* im */
    }, { 0.017051616425953764,         /* re */
      -1.1102230246251565E-16          /* im */
    }, { 0.0054960533857819627,        /* re */
      0.0                              /* im */
    }, { 0.017051616425953764,         /* re */
      1.1102230246251565E-16           /* im */
    }, { 0.079785316957940555,         /* re */
      0.0                              /* im */
    }, { 0.29947757179738455,          /* re */
      -1.1102230246251565E-16          /* im */
    }, { 0.884128395962422,            /* re */
      0.0                              /* im */
    }, { 2.0520667281565834,           /* re */
      -1.1102230246251565E-16          /* im */
    }, { 3.7444564171215027,           /* re */
      0.0                              /* im */
    }, { 5.3716432611943521,           /* re */
      1.1102230246251565E-16           /* im */
    }, { 8.6909050655080531,           /* re */
      1.1807136369252272E-16           /* im */
    }, { 7.7059386226522637,           /* re */
      2.2204460482163373E-16           /* im */
    }, { 5.3716432611943521,           /* re */
      1.0339757656912846E-25           /* im */
    }, { 2.9438105785985371,           /* re */
      2.2204460482163373E-16           /* im */
    }, { 1.2683342550032974,           /* re */
      -1.6939624969320315E-21          /* im */
    }, { 0.42961821456074656,          /* re */
      2.2204460482163373E-16           /* im */
    }, { 0.11445673615526841,          /* re */
      1.0339757656912846E-25           /* im */
    }, { 0.024461548022866264,         /* re */
      2.2204460482163373E-16           /* im */
    }, { 0.0078844122735421962,        /* re */
      -1.1806797535393855E-16          /* im */
    }, { 0.024461548022866264,         /* re */
      -2.2204460502842888E-16          /* im */
    }, { 0.11445673615526841,          /* re */
      1.0339757656912846E-25           /* im */
    }, { 0.42961821456074656,          /* re */
      -2.2204460502842888E-16          /* im */
    }, { 1.2683342550032974,           /* re */
      -1.6939624969320315E-21          /* im */
    }, { 2.9438105785985371,           /* re */
      -2.2204460502842888E-16          /* im */
    }, { 5.3716432611943521,           /* re */
      1.0339757656912846E-25           /* im */
    }, { 7.7059386226522637,           /* re */
      -2.2204460502842888E-16          /* im */
    } };

  double brm;
  double patch[256];
  double bim;
  FILE * a;
  boolean_T exitg1;
  boolean_T b_a;
  int ii_size_idx_0;
  int jj_size_idx_0;
  int jj;
  int ii_data[1];
  signed char jj_data[1];
  double vert_delta_data[1];
  signed char horiz_delta_data[1];
  boolean_T b_vert_delta_data[1];
  double c_vert_delta_data[2];
  double x_re;
  (void)frame_begin;
  (void)frame_num;
  for (ii = 0; ii < 2; ii++) {
    pos[ii] = 29.0 + 94.0 * (double)ii;
  }

  fileid = cfopen("pos_4.txt", "wb");
  memset(&model_xf[0], 0, sizeof(creal_T) << 8);
  memset(&model_alphaf[0], 0, sizeof(creal_T) << 8);

  /* %%%%%%%%%%%%%%%% */
  /* to calculate precision */
  b_NULL = NULL;
  for (frame = 0; frame < 80; frame++) {
    if (1 + frame == 1) {
      r2br_r2dit_trig(dv0, dv1, dcv0);
      for (ii = 0; ii < 16; ii++) {
        for (ixstart = 0; ixstart < 16; ixstart++) {
          b_model_alphaf[ixstart + (ii << 4)] = dcv0[ii + (ixstart << 4)];
        }
      }

      b_r2br_r2dit_trig(b_model_alphaf, dv0, dv1, xf);

      /* Kernel Ridge Regression, calculate alphas (in Fourier domain) */
      linear_correlation(xf, xf, model_alphaf);
      for (ii = 0; ii < 256; ii++) {
        mtmp = model_alphaf[ii].re + 0.0001;
        bi = model_alphaf[ii].im;
        if (bi == 0.0) {
          if (x[ii].im == 0.0) {
            model_alphaf[ii].re = x[ii].re / mtmp;
            model_alphaf[ii].im = 0.0;
          } else {
            model_alphaf[ii].re = x[ii].re / mtmp;
            model_alphaf[ii].im = x[ii].im / mtmp;
          }
        } else if (mtmp == 0.0) {
          if (x[ii].im == 0.0) {
            model_alphaf[ii].re = 0.0;
            model_alphaf[ii].im = -(x[ii].re / bi);
          } else {
            model_alphaf[ii].re = x[ii].im / bi;
            model_alphaf[ii].im = -(x[ii].re / bi);
          }
        } else {
          brm = fabs(mtmp);
          bim = fabs(bi);
          if (brm > bim) {
            bim = bi / mtmp;
            mtmp += bim * bi;
            model_alphaf[ii].re = (x[ii].re + bim * x[ii].im) / mtmp;
            model_alphaf[ii].im = (x[ii].im - bim * x[ii].re) / mtmp;
          } else if (bim == brm) {
            if (mtmp > 0.0) {
              bim = 0.5;
            } else {
              bim = -0.5;
            }

            if (bi > 0.0) {
              mtmp = 0.5;
            } else {
              mtmp = -0.5;
            }

            model_alphaf[ii].re = (x[ii].re * bim + x[ii].im * mtmp) / brm;
            model_alphaf[ii].im = (x[ii].im * bim - x[ii].re * mtmp) / brm;
          } else {
            bim = mtmp / bi;
            mtmp = bi + bim * mtmp;
            model_alphaf[ii].re = (bim * x[ii].re + x[ii].im) / mtmp;
            model_alphaf[ii].im = (bim * x[ii].im - x[ii].re) / mtmp;
          }
        }

        model_xf[ii] = xf[ii];
      }
    } else {
      r2br_r2dit_trig(dv0, dv1, dcv0);
      for (ii = 0; ii < 16; ii++) {
        for (ixstart = 0; ixstart < 16; ixstart++) {
          b_model_alphaf[ixstart + (ii << 4)] = dcv0[ii + (ixstart << 4)];
        }
      }

      b_r2br_r2dit_trig(b_model_alphaf, dv0, dv1, dcv1);
      linear_correlation(dcv1, model_xf, xf);
      for (ii = 0; ii < 16; ii++) {
        for (ixstart = 0; ixstart < 16; ixstart++) {
          b_model_alphaf[ixstart + (ii << 4)].re = model_alphaf[ii + (ixstart <<
            4)].re * xf[ii + (ixstart << 4)].re - model_alphaf[ii + (ixstart <<
            4)].im * xf[ii + (ixstart << 4)].im;
          b_model_alphaf[ixstart + (ii << 4)].im = model_alphaf[ii + (ixstart <<
            4)].re * xf[ii + (ixstart << 4)].im + model_alphaf[ii + (ixstart <<
            4)].im * xf[ii + (ixstart << 4)].re;
        }
      }

      c_r2br_r2dit_trig(b_model_alphaf, dv0, dv2, dcv0);
      for (ii = 0; ii < 16; ii++) {
        for (ixstart = 0; ixstart < 16; ixstart++) {
          b_model_alphaf[ixstart + (ii << 4)] = dcv0[ii + (ixstart << 4)];
        }
      }

      c_r2br_r2dit_trig(b_model_alphaf, dv0, dv2, dcv0);
      for (ii = 0; ii < 256; ii++) {
        patch[ii] = dcv0[ii].re;
      }

      ixstart = 1;
      mtmp = patch[0];
      if (rtIsNaN(patch[0])) {
        ii = 2;
        exitg1 = false;
        while ((!exitg1) && (ii < 257)) {
          ixstart = ii;
          if (!rtIsNaN(patch[ii - 1])) {
            mtmp = patch[ii - 1];
            exitg1 = true;
          } else {
            ii++;
          }
        }
      }

      if (ixstart < 256) {
        while (ixstart + 1 < 257) {
          if (patch[ixstart] > mtmp) {
            mtmp = patch[ixstart];
          }

          ixstart++;
        }
      }

      ixstart = 0;
      ii_size_idx_0 = 1;
      jj_size_idx_0 = 1;
      ii = 1;
      jj = 1;
      exitg1 = false;
      while ((!exitg1) && (jj <= 16)) {
        if (patch[(ii + ((jj - 1) << 4)) - 1] == mtmp) {
          ixstart = 1;
          ii_data[0] = ii;
          jj_data[0] = (signed char)jj;
          exitg1 = true;
        } else {
          ii++;
          if (ii > 16) {
            ii = 1;
            jj++;
          }
        }
      }

      if (ixstart == 0) {
        ii_size_idx_0 = 0;
        jj_size_idx_0 = 0;
      }

      for (ii = 0; ii < ii_size_idx_0; ii++) {
        vert_delta_data[ii] = ii_data[ii];
      }

      for (ii = 0; ii < jj_size_idx_0; ii++) {
        horiz_delta_data[ii] = jj_data[ii];
      }

      ii_data[0] = ii_size_idx_0;
      for (ii = 0; ii < ii_size_idx_0; ii++) {
        b_vert_delta_data[ii] = (vert_delta_data[ii] > 8.0);
      }

      if (ifWhileCond(b_vert_delta_data, ii_data)) {
        /* wrap around to negative half-space of vertical axis */
        for (ii = 0; ii < ii_size_idx_0; ii++) {
          vert_delta_data[ii] -= 16.0;
        }
      }

      ii_data[0] = jj_size_idx_0;
      for (ii = 0; ii < jj_size_idx_0; ii++) {
        b_vert_delta_data[ii] = (horiz_delta_data[ii] > 8);
      }

      if (ifWhileCond(b_vert_delta_data, ii_data)) {
        /* same for horizontal axis */
        for (ii = 0; ii < jj_size_idx_0; ii++) {
          horiz_delta_data[ii] = (signed char)(horiz_delta_data[ii] - 16);
        }
      }

      for (ii = 0; ii < ii_size_idx_0; ii++) {
        c_vert_delta_data[ii] = vert_delta_data[ii] - 1.0;
      }

      for (ii = 0; ii < jj_size_idx_0; ii++) {
        c_vert_delta_data[ii + ii_size_idx_0] = (double)horiz_delta_data[ii] -
          1.0;
      }

      for (ii = 0; ii < 2; ii++) {
        pos[ii] += c_vert_delta_data[ii];
      }

      /* obtain a subwindow for training at newly estimated target position */
      r2br_r2dit_trig(dv0, dv1, dcv0);
      for (ii = 0; ii < 16; ii++) {
        for (ixstart = 0; ixstart < 16; ixstart++) {
          b_model_alphaf[ixstart + (ii << 4)] = dcv0[ii + (ixstart << 4)];
        }
      }

      b_r2br_r2dit_trig(b_model_alphaf, dv0, dv1, xf);

      /* Kernel Ridge Regression, calculate alphas (in Fourier domain) */
      /* equation for fast training */
      linear_correlation(xf, xf, dcv0);
      for (ii = 0; ii < 256; ii++) {
        mtmp = dcv0[ii].re + 0.0001;
        bi = dcv0[ii].im;
        if (bi == 0.0) {
          if (x[ii].im == 0.0) {
            x_re = x[ii].re / mtmp;
            mtmp = 0.0;
          } else {
            x_re = x[ii].re / mtmp;
            mtmp = x[ii].im / mtmp;
          }
        } else if (mtmp == 0.0) {
          if (x[ii].im == 0.0) {
            x_re = 0.0;
            mtmp = -(x[ii].re / bi);
          } else {
            x_re = x[ii].im / bi;
            mtmp = -(x[ii].re / bi);
          }
        } else {
          brm = fabs(mtmp);
          bim = fabs(bi);
          if (brm > bim) {
            bim = bi / mtmp;
            mtmp += bim * bi;
            x_re = (x[ii].re + bim * x[ii].im) / mtmp;
            mtmp = (x[ii].im - bim * x[ii].re) / mtmp;
          } else if (bim == brm) {
            if (mtmp > 0.0) {
              bim = 0.5;
            } else {
              bim = -0.5;
            }

            if (bi > 0.0) {
              mtmp = 0.5;
            } else {
              mtmp = -0.5;
            }

            x_re = (x[ii].re * bim + x[ii].im * mtmp) / brm;
            mtmp = (x[ii].im * bim - x[ii].re * mtmp) / brm;
          } else {
            bim = mtmp / bi;
            mtmp = bi + bim * mtmp;
            x_re = (bim * x[ii].re + x[ii].im) / mtmp;
            mtmp = (bim * x[ii].im - x[ii].re) / mtmp;
          }
        }

        model_alphaf[ii].re = 0.925 * model_alphaf[ii].re + 0.075 * x_re;
        model_alphaf[ii].im = 0.925 * model_alphaf[ii].im + 0.075 * mtmp;
        model_xf[ii].re = 0.925 * model_xf[ii].re + 0.075 * xf[ii].re;
        model_xf[ii].im = 0.925 * model_xf[ii].im + 0.075 * xf[ii].im;
      }
    }

    /* save position and timing */
    b_fileid = fileid;
    if (fileid < 0) {
      b_fileid = -1;
    }

    if (b_fileid >= 3) {
      if (!eml_openfiles_not_empty) {
        a = NULL;
        for (ixstart = 0; ixstart < 20; ixstart++) {
          eml_autoflush[ixstart] = false;
          eml_openfiles[ixstart] = a;
        }

        eml_openfiles_not_empty = true;
      }

      a = eml_openfiles[b_fileid - 3];
      b_a = eml_autoflush[b_fileid - 3];
    } else if (b_fileid == 0) {
      a = stdin;
      b_a = true;
    } else if (b_fileid == 1) {
      a = stdout;
      b_a = true;
    } else if (b_fileid == 2) {
      a = stderr;
      b_a = true;
    } else {
      a = NULL;
      b_a = true;
    }

    if (!(a == b_NULL)) {
      fprintf(a, "%f %f\n", pos[0], pos[1]);
      if (b_a) {
        fflush(a);
      }
    }
  }

  b_fclose(fileid);
}

/*
 * File trailer for kcf_single.c
 *
 * [EOF]
 */
